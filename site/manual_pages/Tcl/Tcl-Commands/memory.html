<h1 id="name">NAME</h1>
<p>memory - Control Tcl memory debugging capabilities</p>
<h1 id="synopsis">SYNOPSIS</h1>
<p><strong>memory</strong> <em>option</em> ?<em>arg arg ...</em>?</p>
<h1 id="description">DESCRIPTION</h1>
<p>The <strong>memory</strong> command gives the Tcl developer control
of Tcl's memory debugging capabilities. The memory command has several
suboptions, which are described below. It is only available when Tcl has
been compiled with memory debugging enabled (when
<strong>TCL_MEM_DEBUG</strong> is defined at compile time), and after
<strong>Tcl_InitMemory</strong> has been called.</p>
<dl>
<dt><strong>memory active</strong> <em>file</em></dt>
<dd>
<p>Write a list of all currently allocated memory to the specified
<em>file</em>.</p>
</dd>
<dt><strong>memory break_on_malloc</strong> <em>count</em></dt>
<dd>
<p>After the <em>count</em> allocations have been performed,
<strong>ckalloc</strong> outputs a message to this effect and that it is
now attempting to enter the C debugger. Tcl will then issue a
<em>SIGINT</em> signal against itself. If you are running Tcl under a C
debugger, it should then enter the debugger command mode.</p>
</dd>
<dt><strong>memory info</strong></dt>
<dd>
<p>Returns a report containing the total allocations and frees since Tcl
began, the current packets allocated (the current number of calls to
<strong>ckalloc</strong> not met by a corresponding call to
<strong>ckfree</strong>), the current bytes allocated, and the maximum
number of packets and bytes allocated.</p>
</dd>
<dt><strong>memory init</strong>
[<strong>on</strong>|<strong>off</strong>]</dt>
<dd>
<p>Turn on or off the pre-initialization of all allocated memory with
bogus bytes. Useful for detecting the use of uninitialized values.</p>
</dd>
<dt><strong>memory objs</strong> <em>file</em></dt>
<dd>
<p>Causes a list of all allocated Tcl_Obj values to be written to the
specified <em>file</em> immediately, together with where they were
allocated. Useful for checking for leaks of values.</p>
</dd>
<dt><strong>memory onexit</strong> <em>file</em></dt>
<dd>
<p>Causes a list of all allocated memory to be written to the specified
<em>file</em> during the finalization of Tcl's memory subsystem. Useful
for checking that memory is properly cleaned up during process exit.</p>
</dd>
<dt><strong>memory tag</strong> <em>string</em></dt>
<dd>
<p>Each packet of memory allocated by <strong>ckalloc</strong> can have
associated with it a string-valued tag. In the lists of allocated memory
generated by <strong>memory active</strong> and <strong>memory
onexit</strong>, the tag for each packet is printed along with other
information about the packet. The <strong>memory tag</strong> command
sets the tag value for subsequent calls to <strong>ckalloc</strong> to
be <em>string</em>.</p>
</dd>
<dt><strong>memory trace</strong>
[<strong>on</strong>|<strong>off</strong>]</dt>
<dd>
<p>Turns memory tracing on or off. When memory tracing is on, every call
to <strong>ckalloc</strong> causes a line of trace information to be
written to <em>stderr</em>, consisting of the word <em>ckalloc</em>,
followed by the address returned, the amount of memory allocated, and
the C filename and line number of the code performing the allocation.
For example:</p>
<pre><code>ckalloc 40e478 98 tclProc.c 1406</code></pre>
<p>Calls to <strong>ckfree</strong> are traced in the same manner.</p>
</dd>
<dt><strong>memory trace_on_at_malloc</strong> <em>count</em></dt>
<dd>
<p>Enable memory tracing after <em>count</em> <strong>ckalloc</strong>s
have been performed. For example, if you enter <strong>memory
trace_on_at_malloc 100</strong>, after the 100th call to
<strong>ckalloc</strong>, memory trace information will begin being
displayed for all allocations and frees. Since there can be a lot of
memory activity before a problem occurs, judicious use of this option
can reduce the slowdown caused by tracing (and the amount of trace
information produced), if you can identify a number of allocations that
occur before the problem sets in. The current number of memory
allocations that have occurred since Tcl started is printed on a guard
zone failure.</p>
</dd>
<dt><strong>memory validate</strong>
[<strong>on</strong>|<strong>off</strong>]</dt>
<dd>
<p>Turns memory validation on or off. When memory validation is enabled,
on every call to <strong>ckalloc</strong> or <strong>ckfree</strong>,
the guard zones are checked for every piece of memory currently in
existence that was allocated by <strong>ckalloc</strong>. This has a
large performance impact and should only be used when overwrite problems
are strongly suspected. The advantage of enabling memory validation is
that a guard zone overwrite can be detected on the first call to
<strong>ckalloc</strong> or <strong>ckfree</strong> after the overwrite
occurred, rather than when the specific memory with the overwritten
guard zone(s) is freed, which may occur long after the overwrite
occurred.</p>
</dd>
</dl>
<h1 id="see-also">SEE ALSO</h1>
<p><a href="../Tcl-C-API/Alloc.html">ckalloc</a>, <a
href="../Tcl-C-API/Alloc.html">ckfree</a>, <a
href="../Tcl-C-API/DumpActiveMemory.html">Tcl_ValidateAllMemory</a>, <a
href="../Tcl-C-API/DumpActiveMemory.html">Tcl_DumpActiveMemory</a>, <a
href="../Tcl-C-API/TCL_MEM_DEBUG.html">TCL_MEM_DEBUG</a></p>
<h1 id="keywords">KEYWORDS</h1>
<p>memory, debug</p>
